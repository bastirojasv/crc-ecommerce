import{A as y,B as b,C as p,H as h,I as c,J as S,M as _,N as f,O as C,P as E,V as P,W as I,Y as O,ba as V,fa as T,g as M,ha as F,i as l,ia as W,j as s,ja as L,ka as q,la as k,ma as N,na as j,o as w,oa as D,q as m,r as x,sa as z,ta as B,u,ua as R,v as d,va as A,wa as Q,x as r,xa as G,y as i,z as v}from"./chunk-3NZJIHVT.js";function H(a,g){a&1&&(r(0,"div",5)(1,"div",6),c(2,"\u{1F6D2}"),i(),r(3,"h3",7),c(4,"Tu carrito est\xE1 vac\xEDo"),i(),r(5,"p",8),c(6,"Agrega productos para enviar tu solicitud de compra."),i(),r(7,"a",9),c(8," Ir al cat\xE1logo "),i()())}function U(a,g){if(a&1){let e=y();r(0,"div",27)(1,"div",28)(2,"div",29),v(3,"img",30),i(),r(4,"div",31)(5,"h5",18),c(6),i(),r(7,"input",32),C("ngModelChange",function(t){let n=l(e).$implicit;return f(n.quantity,t)||(n.quantity=t),s(t)}),b("change",function(){let t=l(e).$implicit,n=p(2);return s(n.updateQuantity(t.product.id,t.quantity))}),i()(),r(8,"div",33)(9,"button",34),b("click",function(){let t=l(e).$implicit,n=p(2);return s(n.remove(t.product.id))}),v(10,"i",35),c(11," Quitar "),i()()()()}if(a&2){let e=g.$implicit;m(3),d("src","assets/images/"+e.product.images[0],w)("alt",e.product.name),m(3),S(e.product.name),m(),_("ngModel",e.quantity)}}function J(a,g){a&1&&(r(0,"div",36),c(1," El nombre es obligatorio. "),i())}function K(a,g){a&1&&(r(0,"div",36),c(1," Ingresa un correo v\xE1lido. "),i())}function X(a,g){a&1&&(r(0,"span"),c(1,"Enviar solicitud"),i())}function Y(a,g){a&1&&v(0,"span",37)}function Z(a,g){if(a&1){let e=y();r(0,"div")(1,"div",10)(2,"h2",11),c(3,"Resumen de tu pedido"),i(),r(4,"div",12)(5,"div",13),u(6,U,12,4,"div",14),i(),r(7,"div",15)(8,"div",16)(9,"h5",7),c(10,"Datos de contacto"),i(),r(11,"form",17,0),b("ngSubmit",function(){l(e);let t=p();return s(t.submitForm())}),r(13,"div",18)(14,"label",19),c(15,"Nombre"),i(),r(16,"input",20,1),C("ngModelChange",function(t){l(e);let n=p();return f(n.contact.name,t)||(n.contact.name=t),s(t)}),i(),u(18,J,2,0,"div",21),i(),r(19,"div",18)(20,"label",19),c(21,"Correo electr\xF3nico"),i(),r(22,"input",22,2),C("ngModelChange",function(t){l(e);let n=p();return f(n.contact.email,t)||(n.contact.email=t),s(t)}),i(),u(24,K,2,0,"div",21),i(),r(25,"div",18)(26,"label",19),c(27,"Empresa (opcional)"),i(),r(28,"input",23),C("ngModelChange",function(t){l(e);let n=p();return f(n.contact.company,t)||(n.contact.company=t),s(t)}),i()(),r(29,"div",7)(30,"label",19),c(31,"Comentario"),i(),r(32,"textarea",24),C("ngModelChange",function(t){l(e);let n=p();return f(n.contact.message,t)||(n.contact.message=t),s(t)}),i()(),r(33,"button",25),u(34,X,2,0,"span",4)(35,Y,1,0,"span",26),i()()()()()()()}if(a&2){let e=h(12),o=h(17),t=h(23),n=p();m(6),d("ngForOf",n.cartItems),m(10),_("ngModel",n.contact.name),m(2),d("ngIf",o.invalid&&o.touched),m(4),_("ngModel",n.contact.email),m(2),d("ngIf",t.invalid&&t.touched),m(4),_("ngModel",n.contact.company),m(4),_("ngModel",n.contact.message),m(),d("disabled",!e.valid||n.isLoading),m(),d("ngIf",!n.isLoading),m(),d("ngIf",n.isLoading)}}var dt=(()=>{class a{constructor(e,o,t){this.cartService=e,this.emailService=o,this.titleService=t,this.templateId="template_yy1qxjq",this.cartItems=[],this.isLoading=!1,this.contact={name:"",email:"",company:"",message:""}}ngOnInit(){this.titleService.setTitle("Carrito | CRC Comercial SPA"),this.cartService.getCart().subscribe(e=>{this.cartItems=e})}submitForm(){if(!this.contact.name||!this.contact.email)return;this.isLoading=!0;let e={name:this.contact.name,email:this.contact.email,company:this.contact.company,message:this.contact.message,products:this.cartItems.map(o=>`- ${o.product.name} (x${o.quantity})`).join(`
`)};this.emailService.sendTemplate(this.templateId,e).then(()=>{this.isLoading=!1,new bootstrap.Modal(document.getElementById("successModal")).show(),this.cartService.clearCart(),this.contact={name:"",email:"",company:"",message:""}}).catch(()=>{this.isLoading=!1,alert("Hubo un error al enviar tu solicitud. Intenta m\xE1s tarde.")})}updateQuantity(e,o){this.cartService.updateQuantity(e,o)}remove(e){this.cartService.removeFromCart(e)}getTotal(){return this.cartItems.reduce((e,o)=>e+o.quantity,0)}static{this.\u0275fac=function(o){return new(o||a)(x(Q),x(G),x(V))}}static{this.\u0275cmp=M({type:a,selectors:[["app-cart"]],standalone:!0,features:[E],decls:2,vars:2,consts:[["contactForm","ngForm"],["name","ngModel"],["email","ngModel"],["class","empty-cart text-center py-5",4,"ngIf"],[4,"ngIf"],[1,"empty-cart","text-center","py-5"],[1,"emoji","mb-3"],[1,"mb-3"],[1,"text-muted","mb-4"],["routerLink","/products",1,"btn","btn-warning","px-4"],[1,"container","my-5"],[1,"mb-4","text-uppercase","fw-bold"],[1,"row"],[1,"col-md-8"],["class","cart-item card mb-3",4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"summary-box","card","p-4"],["novalidate","",3,"ngSubmit"],[1,"mb-2"],[1,"form-label"],["type","text","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["class","text-danger small mt-1",4,"ngIf"],["type","email","name","email","required","","pattern","[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}$",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","company",1,"form-control",3,"ngModelChange","ngModel"],["rows","4","name","message",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-warning","w-100","d-flex","align-items-center","justify-content-center",3,"disabled"],["class","spinner-border spinner-border-sm text-light","role","status",4,"ngIf"],[1,"cart-item","card","mb-3"],[1,"row","g-0","align-items-center","p-2"],[1,"col-md-2","text-center"],[1,"img-fluid",3,"src","alt"],[1,"col-md-6"],["type","number","min","1",1,"form-control","form-control-sm","quantity-input",3,"ngModelChange","change","ngModel"],[1,"col-md-4","text-end"],[1,"btn","btn-link","text-danger",3,"click"],[1,"fas","fa-trash-alt","me-1"],[1,"text-danger","small","mt-1"],["role","status",1,"spinner-border","spinner-border-sm","text-light"]],template:function(o,t){o&1&&u(0,H,9,0,"div",3)(1,Z,36,10,"div",4),o&2&&(d("ngIf",t.cartItems.length===0),m(),d("ngIf",t.cartItems.length>0))},dependencies:[O,P,I,F,T,A,j,W,D,L,q,B,R,z,N,k],styles:[".card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 10px #0000000d;border:none}img[_ngcontent-%COMP%]{max-height:80px;object-fit:contain;background-color:#fff;border-radius:8px;padding:6px}input[type=number][_ngcontent-%COMP%]{width:80px;text-align:center;border-radius:8px;border:1px solid #ccc;padding:6px;margin-top:8px}.btn-outline-danger[_ngcontent-%COMP%]{border-radius:8px}.total-card[_ngcontent-%COMP%]{border-radius:12px;background-color:#fffbe6;border:1px solid #ffecb3;box-shadow:0 0 5px #ff98001a}.total-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.25rem;color:#fce434}.total-card[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-top:1rem;border-radius:25px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{border-radius:8px}.modal-content[_ngcontent-%COMP%]{border-radius:16px;box-shadow:0 2px 20px #00000026}.empty-cart[_ngcontent-%COMP%]   .emoji[_ngcontent-%COMP%]{font-size:64px}.empty-cart[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600;color:#333}.empty-cart[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px}.empty-cart[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:30px;font-weight:500}.empty-cart[_ngcontent-%COMP%]   .btn-warning[_ngcontent-%COMP%]{background-color:#fce434;border:none;color:#fff}.text-danger[_ngcontent-%COMP%]{font-size:13px}.btn-warning[_ngcontent-%COMP%]{background-color:#fce434;border:none;color:#fff}.btn-warning[_ngcontent-%COMP%]:hover{background-color:#e0c100}"]})}}return a})();export{dt as CartComponent};
