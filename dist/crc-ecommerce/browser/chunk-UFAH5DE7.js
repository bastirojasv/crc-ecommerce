import{a as Y}from"./chunk-ZUS65BG5.js";import{a as R,b as U}from"./chunk-N2NEAN2G.js";import{A as k,B as C,C as m,D as g,J as l,K as S,L as T,M as F,N as v,O as x,P as M,Q as I,Y as E,Z as V,a as O,aa as A,b,fa as W,ga as z,h as y,ia as B,j as h,k as P,ma as N,na as j,q as w,qa as q,r as a,s as u,ta as L,ua as D,v as f,va as Q,w as d,x as _,y as o,z as r,za as H}from"./chunk-4SWELNVS.js";function Z(i,p){if(i&1){let e=C();o(0,"div",17)(1,"input",18),m("change",function(t){let s=h(e).$implicit,c=g();return P(c.onCategoryChange(t,s.id))}),r(),o(2,"label",19),l(3),r()()}if(i&2){let e=p.$implicit,n=g();a(),d("id","cat-"+e.id)("checked",n.selectedCategories.includes(e.id)),a(),d("for","cat-"+e.id),a(),T(" ",e.name," ")}}function $(i,p){i&1&&(o(0,"div",20)(1,"div",21),l(2,"\u{1F4E6}"),r(),o(3,"h3",22),l(4,"A\xFAn no tenemos productos disponibles"),r(),o(5,"p"),l(6,"Estamos agregando productos. Te invitamos a volver pronto."),r(),o(7,"a",23),l(8,"Volver al inicio"),r()())}function G(i,p){if(i&1&&(o(0,"div",25),k(1,"app-product-card",26),r()),i&2){let e=p.$implicit,n=g(2);a(),d("product",e)("queryParams",n.queryParams)}}function J(i,p){if(i&1&&(o(0,"div",1),f(1,G,2,2,"div",24),r()),i&2){let e=g();a(),d("ngForOf",e.paginatedProducts)}}function K(i,p){if(i&1){let e=C();o(0,"li",29)(1,"button",30),m("click",function(){let t=h(e).$implicit,s=g(2);return P(s.goToPage(t))}),l(2),r()()}if(i&2){let e=p.$implicit,n=g(2);_("active",e===n.currentPage),a(2),S(e)}}function X(i,p){if(i&1){let e=C();o(0,"div",27)(1,"nav")(2,"ul",28)(3,"li",29)(4,"button",30),m("click",function(){h(e);let t=g();return P(t.previousPage())}),l(5,"\xAB"),r()(),f(6,K,3,3,"li",31),o(7,"li",29)(8,"button",30),m("click",function(){h(e);let t=g();return P(t.nextPage())}),l(9,"\xBB"),r()()()()()}if(i&2){let e=g();a(3),_("disabled",e.currentPage===1),a(3),d("ngForOf",e.visiblePages),a(),_("disabled",e.currentPage===e.totalPages)}}function ee(i,p){if(i&1&&(o(0,"div",32),l(1),r()),i&2){let e=g();a(),F(" Mostrando ",e.startItem," - ",e.endItem," de ",e.filteredProducts.length," productos ")}}var ge=(()=>{class i{constructor(e,n,t,s,c){this.productService=e,this.categoryService=n,this.route=t,this.titleService=s,this.router=c,this.products=[],this.categories=[],this.filteredProducts=[],this.paginatedProducts=[],this.searchText="",this.selectedCategories=[],this.sortOption="",this.currentPage=1,this.itemsPerPage=12,this.queryParams={},this.isMobile=!1}ngOnInit(){this.titleService.setTitle("Productos | CRC Comercial SPA"),this.categoryService.getCategories().subscribe(e=>this.categories=e),this.productService.getProducts().subscribe(e=>{this.products=e,this.route.queryParams.subscribe(n=>{this.syncFiltersWithParams(n),this.applyFilters(),this.updatePaginatedProducts()})}),this.isMobile=window.innerWidth<768}syncFiltersWithParams(e){this.searchText=e.search||"",this.selectedCategories=e.categories?Array.isArray(e.categories)?e.categories.map(Number):e.categories.split(",").map(Number):[],this.currentPage=e.page?+e.page:1}applyFilters(){let e=[...this.products];if(this.searchText.trim()){let n=this.searchText.trim().toLowerCase();e=e.filter(t=>t.name.toLowerCase().includes(n)||t.description&&t.description.toLowerCase().includes(n))}this.selectedCategories.length>0&&(e=e.filter(n=>this.selectedCategories.includes(n.categoryId))),this.sortOption==="name-asc"?e.sort((n,t)=>n.name.localeCompare(t.name)):this.sortOption==="name-desc"&&e.sort((n,t)=>t.name.localeCompare(n.name)),this.filteredProducts=e}updatePaginatedProducts(){let e=(this.currentPage-1)*this.itemsPerPage,n=e+this.itemsPerPage;this.paginatedProducts=this.filteredProducts.slice(e,n)}goToPage(e){this.currentPage=e,this.updateQueryParams(e)}updateQueryParams(e){this.router.navigate([],{relativeTo:this.route,queryParams:b(O({},this.queryParams),{search:this.searchText||void 0,categories:this.selectedCategories.length?this.selectedCategories:void 0,sort:this.sortOption||void 0,page:e??this.currentPage}),queryParamsHandling:"merge",replaceUrl:!0})}onCategoryChange(e,n){e.target.checked?this.selectedCategories.includes(n)||this.selectedCategories.push(n):this.selectedCategories=this.selectedCategories.filter(t=>t!==n),this.currentPage=1,this.updateQueryParams()}onSearchChange(){this.currentPage=1,this.updateQueryParams()}onSortChange(){this.currentPage=1,this.updateQueryParams()}clearFilters(){this.searchText="",this.selectedCategories=[],this.sortOption="",this.currentPage=1,this.updateQueryParams()}get totalPages(){return Math.ceil(this.filteredProducts.length/this.itemsPerPage)}get startItem(){return(this.currentPage-1)*this.itemsPerPage+1}get endItem(){return Math.min(this.startItem+this.itemsPerPage-1,this.filteredProducts.length)}get visiblePages(){let e=this.totalPages,n=this.currentPage,t=2,s=[];for(let c=Math.max(1,n-t);c<=Math.min(e,n+t);c++)s.push(c);return s}previousPage(){this.currentPage>1&&this.goToPage(this.currentPage-1)}nextPage(){this.currentPage<this.totalPages&&this.goToPage(this.currentPage+1)}onResize(){this.isMobile=window.innerWidth<768}static{this.\u0275fac=function(n){return new(n||i)(u(U),u(R),u(z),u(W),u(B))}}static{this.\u0275cmp=y({type:i,selectors:[["app-productos"]],hostBindings:function(n,t){n&1&&m("resize",function(){return t.onResize()},!1,w)},standalone:!0,features:[I],decls:22,vars:7,consts:[[1,"container"],[1,"row"],[1,"col-md-3","mb-4"],[1,"filter-container","p-3","rounded","shadow-sm"],[1,"mb-3"],["type","text","placeholder","Busca un producto",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],["value","name-asc"],["value","name-desc"],["class","form-check mb-2",4,"ngFor","ngForOf"],[1,"btn","btn-outline-warning","w-100","mt-3",3,"click"],[1,"col-md-9"],["class","text-center py-5",4,"ngIf"],["class","row",4,"ngIf"],["class","d-flex justify-content-center mt-4",4,"ngIf"],["class","text-center my-3",4,"ngIf"],[1,"form-check","mb-2"],["type","checkbox",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label",3,"for"],[1,"text-center","py-5"],[2,"font-size","64px"],[1,"mt-3"],["routerLink","/",1,"btn","btn-warning","mt-3"],["class","col-lg-3 col-md-4 col-sm-6 mb-4",4,"ngFor","ngForOf"],[1,"col-lg-3","col-md-4","col-sm-6","mb-4"],[3,"product","queryParams"],[1,"d-flex","justify-content-center","mt-4"],[1,"pagination","mb-0"],[1,"page-item"],[1,"page-link",3,"click"],["class","page-item",3,"active",4,"ngFor","ngForOf"],[1,"text-center","my-3"]],template:function(n,t){n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"input",5),M("ngModelChange",function(c){return x(t.searchText,c)||(t.searchText=c),c}),m("ngModelChange",function(){return t.onSearchChange()}),r()(),o(6,"div",4)(7,"select",6),M("ngModelChange",function(c){return x(t.sortOption,c)||(t.sortOption=c),c}),m("change",function(){return t.onSortChange()}),o(8,"option",7),l(9,"Ordenar por"),r(),o(10,"option",8),l(11,"Nombre A-Z"),r(),o(12,"option",9),l(13,"Nombre Z-A"),r()()(),f(14,Z,4,4,"div",10),o(15,"button",11),m("click",function(){return t.clearFilters()}),l(16," Borrar Filtros "),r()()(),o(17,"div",12),f(18,$,9,0,"div",13)(19,J,2,1,"div",14)(20,X,10,5,"div",15)(21,ee,2,3,"div",16),r()()()),n&2&&(a(5),v("ngModel",t.searchText),a(2),v("ngModel",t.sortOption),a(7),d("ngForOf",t.categories),a(4),d("ngIf",t.paginatedProducts.length===0),a(),d("ngIf",t.paginatedProducts.length>0),a(),d("ngIf",t.paginatedProducts.length>0&&t.totalPages>1),a(),d("ngIf",t.paginatedProducts.length>0))},dependencies:[Y,A,E,V,H,D,Q,N,L,j,q],styles:['@charset "UTF-8";.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;list-style:none;padding-left:0}.pagination[_ngcontent-%COMP%]   .page-item[_ngcontent-%COMP%]{margin:0 5px}.pagination[_ngcontent-%COMP%]   .page-item[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#fff;border:2px solid #fce434;color:#fce434;border-radius:50px;padding:8px 16px;transition:background-color .3s ease,transform .2s ease}.pagination[_ngcontent-%COMP%]   .page-item[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]:hover{background-color:#fce434;color:#fff;transform:scale(1.05)}.pagination[_ngcontent-%COMP%]   .page-item[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]:focus{box-shadow:none}.pagination[_ngcontent-%COMP%]   .page-item.active[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#fce434;color:#fff;font-weight:700;transform:scale(1.1)}.pagination[_ngcontent-%COMP%]   .page-item.disabled[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed;pointer-events:none}.text-center[_ngcontent-%COMP%]{font-size:.9rem;color:#666}.text-center[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600}.text-center[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;color:#666}.category-title[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:600;margin-bottom:1rem;padding-left:10px}.filter-container[_ngcontent-%COMP%]{background:#fff;border:1px solid #ddd;padding-left:1.5rem;position:relative;border-radius:.5rem}.filter-container[_ngcontent-%COMP%]   .form-check[_ngcontent-%COMP%]{padding-left:1.5rem;position:relative}.filter-container[_ngcontent-%COMP%]   .form-check[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{position:relative;left:0;top:.5rem}.filter-container[_ngcontent-%COMP%]   .form-check[_ngcontent-%COMP%]   .form-check-label[_ngcontent-%COMP%]{font-size:.95rem;top:.5rem;position:relative;color:#333}.filter-container[_ngcontent-%COMP%]   .form-check[_ngcontent-%COMP%] + .form-check[_ngcontent-%COMP%]{margin-top:.5rem}@media (max-width: 767px){.filter-container[_ngcontent-%COMP%]{position:static;margin-bottom:20px}}input.form-control[_ngcontent-%COMP%], select.form-control[_ngcontent-%COMP%]{border-radius:10px}.btn-link[_ngcontent-%COMP%]{font-size:.9rem}.input-icon[_ngcontent-%COMP%]{position:relative}.input-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:#aaa;transition:all .3s ease;pointer-events:none}.input-icon[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{padding-left:35px;transition:all .3s ease}.input-icon.focused[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fce434;transform:translateY(-50%) scale(1.2)}.sort-select[_ngcontent-%COMP%]{padding-left:35px;appearance:none;background:none}.input-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{right:12px;left:auto}.btn-outline-warning[_ngcontent-%COMP%]{color:#e0c100;border-color:#e0c100}.btn-outline-warning[_ngcontent-%COMP%]:hover{background-color:#fce434;border:none;color:#fff}.row[_ngcontent-%COMP%]{margin:0 -10px}.col-lg-3[_ngcontent-%COMP%]{padding:0 10px}.container[_ngcontent-%COMP%]{max-width:1320px;margin:0 auto;padding:0 2rem}']})}}return i})();export{ge as ProductsComponent};
